{"id":"emCz1kZoBTXaPMGe","meta":{"instanceId":"f6e8ad6763839b50a3ab3bea5512dc60976f81a6273178925f946fc7a00549a8"},"name":"Tenant Document Compliance Tracking and Reminder System","tags":[],"nodes":[{"id":"cf21f2b4-6cef-4a90-82e7-9bb24923d244","name":"Document Upload Webhook","type":"n8n-nodes-base.webhook","position":[0,0],"webhookId":"f56bea4c-6684-4a56-838e-819df5884c1c","parameters":{"path":"tenant-document-upload","options":{},"httpMethod":"POST","responseMode":"lastNode"},"typeVersion":2.1},{"id":"497dc543-74f7-4172-ad63-bbd1cd4b3aaa","name":"Workflow Configuration","type":"n8n-nodes-base.set","position":[224,0],"parameters":{"options":{},"assignments":{"assignments":[{"id":"id-1","name":"driveFolderId","type":"string","value":"<__PLACEHOLDER_VALUE__Google Drive Folder ID for document storage__>"},{"id":"id-2","name":"sheetsDocumentId","type":"string","value":"<__PLACEHOLDER_VALUE__Google Sheets Document ID for logging__>"},{"id":"id-3","name":"slackChannel","type":"string","value":"<__PLACEHOLDER_VALUE__Slack channel ID for escalations__>"},{"id":"id-4","name":"complianceReportEmail","type":"string","value":"<__PLACEHOLDER_VALUE__Email address for compliance reports__>"}]},"includeOtherFields":true},"typeVersion":3.4},{"id":"1a5b2a0e-9e5a-41e6-8777-aaa020685a06","name":"Normalize Tenant Data","type":"n8n-nodes-base.set","position":[448,0],"parameters":{"options":{},"assignments":{"assignments":[{"id":"id-1","name":"tenantId","type":"string","value":"={{ $json.body.tenantId }}"},{"id":"id-2","name":"tenantName","type":"string","value":"={{ $json.body.tenantName }}"},{"id":"id-3","name":"tenantEmail","type":"string","value":"={{ $json.body.tenantEmail }}"},{"id":"id-4","name":"documentType","type":"string","value":"={{ $json.body.documentType }}"},{"id":"id-5","name":"documentName","type":"string","value":"={{ $json.body.documentName }}"},{"id":"id-6","name":"uploadTimestamp","type":"string","value":"={{ $now.toISO() }}"}]},"includeOtherFields":true},"typeVersion":3.4},{"id":"01e08050-8de0-45b7-81d7-233777889785","name":"Upload to Google Drive","type":"n8n-nodes-base.googleDrive","position":[672,0],"parameters":{"name":"={{ $json.documentName }}","driveId":{"__rl":true,"mode":"list","value":"My Drive"},"options":{},"folderId":{"__rl":true,"mode":"id","value":"={{ $('Workflow Configuration').first().json.driveFolderId }}"}},"credentials":{"googleDriveOAuth2Api":{"id":"088UtvjPSEZronhm","name":"Google Drive account 2"}},"typeVersion":3},{"id":"72853a33-6243-4da1-9a51-b4e11bf5625c","name":"Check Document Completeness","type":"@n8n/n8n-nodes-langchain.openAi","position":[896,0],"parameters":{"modelId":{"mode":"id","value":"gpt-4o-mini"},"options":{"instructions":"You are a document compliance checker. Analyze documents and determine if they are complete and valid for tenant compliance purposes. Consider factors like: all required fields filled, signatures present if needed, dates valid, and document quality acceptable. Respond with only COMPLETE or INCOMPLETE."},"responses":{"values":[{"content":"={{ 'Document Type: ' + $json.documentType + '\nDocument Name: ' + $json.documentName + '\n\nAnalyze if this document is complete and valid for tenant compliance. Return ONLY one word: COMPLETE or INCOMPLETE' }}"}]},"builtInTools":{}},"credentials":{"openAiApi":{"id":"HTy8dVDHzRHtxXLm","name":"n8n free OpenAI API credits"}},"typeVersion":2},{"id":"77e38c97-65d5-4361-b3bf-2a62bfd7c54d","name":"Log Document Status","type":"n8n-nodes-base.googleSheets","position":[1248,0],"parameters":{"columns":{"value":null,"schema":[],"mappingMode":"autoMapInputData","matchingColumns":["Tenant ID"]},"options":{},"operation":"appendOrUpdate","sheetName":{"__rl":true,"mode":"name","value":"Document Log"},"documentId":{"__rl":true,"mode":"id","value":"={{ $('Workflow Configuration').first().json.sheetsDocumentId }}"}},"credentials":{"googleSheetsOAuth2Api":{"id":"5b6oIAuqcO9HRb2A","name":"Google Sheets account 3"}},"typeVersion":4.7},{"id":"71e064ae-b0c8-4cf1-90c3-377176599e0c","name":"Check Completeness Status","type":"n8n-nodes-base.switch","position":[1472,0],"parameters":{"rules":{"values":[{"outputKey":"incomplete","conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"operator":{"type":"string","operation":"contains"},"leftValue":"={{ $json.message.content }}","rightValue":"INCOMPLETE"}]},"renameOutput":true},{"outputKey":"complete","conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"operator":{"type":"string","operation":"contains"},"leftValue":"={{ $json.message.content }}","rightValue":"COMPLETE"}]},"renameOutput":true}]},"options":{}},"typeVersion":3.3},{"id":"85287795-4678-45da-ba08-d0901bb50f46","name":"Send Reminder Email","type":"n8n-nodes-base.emailSend","position":[1696,0],"webhookId":"8b986a9d-0c21-4b95-8bba-e3bb51659829","parameters":{"html":"={{ '<p>Dear ' + $json.tenantName + ',</p><p>We noticed that your ' + $json.documentType + ' document (' + $json.documentName + ') is incomplete.</p><p>Please upload a complete version as soon as possible to maintain compliance.</p><p>Thank you,<br>Property Management Team</p>' }}","options":{},"subject":"={{ 'Reminder: Incomplete Document - ' + $json.documentType }}","toEmail":"={{ $json.tenantEmail }}","fromEmail":"<__PLACEHOLDER_VALUE__Sender email address__>"},"typeVersion":2.1},{"id":"066a4e98-75f6-4562-9c6a-2121dabf1b1a","name":"Wait for Recheck","type":"n8n-nodes-base.wait","position":[1920,0],"webhookId":"5d6075e5-4267-4d2c-a873-004f3f683300","parameters":{"unit":"days","amount":7},"typeVersion":1.1},{"id":"5022287f-95b3-41cf-a5e0-b2cc8a944e4f","name":"Escalate to Slack","type":"n8n-nodes-base.slack","position":[2144,0],"webhookId":"30cfcec9-a338-4d66-b25c-04c34705d9a9","parameters":{"text":"=⚠️ *Document Compliance Escalation*\n\n*Tenant:* {{ $json.tenantName }} (ID: {{ $json.tenantId }})\n*Document Type:* {{ $json.documentType }}\n*Document Name:* {{ $json.documentName }}\n*Status:* Still incomplete after reminder\n*Upload Date:* {{ $json.uploadTimestamp }}\n\nAction required: Follow up with tenant.","select":"channel","channelId":{"__rl":true,"mode":"id","value":"={{ $('Workflow Configuration').first().json.slackChannel }}"},"otherOptions":{}},"typeVersion":2.3},{"id":"f68705aa-6903-4ca3-9e03-dd8338dcb621","name":"Weekly Schedule","type":"n8n-nodes-base.scheduleTrigger","position":[0,224],"parameters":{"rule":{"interval":[{"field":"weeks","triggerAtDay":[1],"triggerAtHour":9}]}},"typeVersion":1.3},{"id":"5fcb90ff-e997-428a-b1e9-7f58370ab2a3","name":"Read Compliance Data","type":"n8n-nodes-base.googleSheets","position":[224,224],"parameters":{"options":{},"sheetName":{"__rl":true,"mode":"name","value":"Document Log"},"documentId":{"__rl":true,"mode":"id","value":"={{ $('Workflow Configuration').first().json.sheetsDocumentId }}"}},"credentials":{"googleSheetsOAuth2Api":{"id":"5b6oIAuqcO9HRb2A","name":"Google Sheets account 3"}},"typeVersion":4.7},{"id":"55bdffa0-ad78-4c16-9415-e609829b7f8a","name":"Aggregate Compliance Status","type":"n8n-nodes-base.aggregate","position":[448,224],"parameters":{"options":{},"aggregate":"aggregateAllItemData"},"typeVersion":1},{"id":"db04dc20-51fd-4154-941f-92c2f946c1f1","name":"Send Compliance Report","type":"n8n-nodes-base.emailSend","position":[672,224],"webhookId":"e034a556-54db-4fe9-98e7-c0f2d6cc33a8","parameters":{"html":"={{ '<h2>Weekly Compliance Report</h2><p>Generated: ' + $now.toISO() + '</p><p>Total documents tracked: ' + $json.data.length + '</p><p>Please review the attached compliance data in your Google Sheets.</p>' }}","options":{},"subject":"={{ 'Weekly Tenant Document Compliance Report - ' + $now.toFormat('yyyy-MM-dd') }}","toEmail":"={{ $('Workflow Configuration').first().json.complianceReportEmail }}","fromEmail":"<__PLACEHOLDER_VALUE__Sender email address__>"},"typeVersion":2.1},{"id":"eab4592f-70cd-46fc-a93e-1924b72949bf","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-32,-160],"parameters":{"color":7,"width":656,"height":320,"content":"## Webhook & Workflow Config"},"typeVersion":1},{"id":"018717f3-5f54-4dfe-899f-bcf616e24012","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[-32,176],"parameters":{"color":7,"width":896,"height":320,"content":"## Schedule Trigger"},"typeVersion":1},{"id":"1fdeb3cd-6a65-42c0-9f79-ac1570f19700","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[640,-192],"parameters":{"color":7,"width":768,"height":352,"content":"## AI Status"},"typeVersion":1},{"id":"4d93eb9f-478e-4c1b-8424-9cbc4c5a0be7","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[1456,-176],"parameters":{"color":7,"width":848,"height":384,"content":"## Classify and Notify"},"typeVersion":1},{"id":"a0e9791f-91e6-46ea-a560-a7e13b35191a","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[-464,-144],"parameters":{"width":320,"height":528,"content":"## Main\n\nThis workflow helps property managers track tenant document compliance.\nIt validates documents using AI, sends reminders, escalates missing items, and generates compliance reports.\n\n## Setup\n\n- Connect document upload form\n- Configure Google Drive folder\n- Set AI validation prompt\n- Connect Sheets, Email, and Slack\n"},"typeVersion":1}],"active":false,"pinData":{},"settings":{"executionOrder":"v1"},"versionId":"2ec505ae-d2cf-49b9-bcab-039963e6e6d3","connections":{"Weekly Schedule":{"main":[[{"node":"Read Compliance Data","type":"main","index":0}]]},"Wait for Recheck":{"main":[[{"node":"Escalate to Slack","type":"main","index":0}]]},"Log Document Status":{"main":[[{"node":"Check Completeness Status","type":"main","index":0}]]},"Send Reminder Email":{"main":[[{"node":"Wait for Recheck","type":"main","index":0}]]},"Read Compliance Data":{"main":[[{"node":"Aggregate Compliance Status","type":"main","index":0}]]},"Normalize Tenant Data":{"main":[[{"node":"Upload to Google Drive","type":"main","index":0}]]},"Upload to Google Drive":{"main":[[{"node":"Check Document Completeness","type":"main","index":0}]]},"Workflow Configuration":{"main":[[{"node":"Normalize Tenant Data","type":"main","index":0}]]},"Document Upload Webhook":{"main":[[{"node":"Workflow Configuration","type":"main","index":0}]]},"Check Completeness Status":{"main":[[{"node":"Send Reminder Email","type":"main","index":0}]]},"Aggregate Compliance Status":{"main":[[{"node":"Send Compliance Report","type":"main","index":0}]]},"Check Document Completeness":{"main":[[{"node":"Log Document Status","type":"main","index":0}]]}}}