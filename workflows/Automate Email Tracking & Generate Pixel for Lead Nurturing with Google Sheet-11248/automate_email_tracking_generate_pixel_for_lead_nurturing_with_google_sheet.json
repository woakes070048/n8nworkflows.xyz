{"id":"HEzuq2Da8re2aFPo","meta":{"instanceId":"a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462","templateCredsSetupCompleted":true},"name":"Generate and detect Tracking Pixel with Google Sheet","tags":[],"nodes":[{"id":"2cde4e1b-498d-473c-8275-d5fbdaa87cea","name":"When clicking ‘Execute workflow’","type":"n8n-nodes-base.manualTrigger","position":[-256,-544],"parameters":{},"typeVersion":1},{"id":"b94e5896-b9a0-48b0-b7c4-d63b057eb51e","name":"Webhook","type":"n8n-nodes-base.webhook","position":[-272,32],"webhookId":"e995cbaa-9259-4685-a144-16a700d0a71d","parameters":{"path":"e995cbaa-9259-4685-a144-16a700d0a71d","options":{},"responseMode":"responseNode"},"typeVersion":2.1},{"id":"daaea3b2-7206-4db6-b55b-5d5b9ab2e750","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","position":[496,-128],"parameters":{"options":{},"respondWith":"binary"},"typeVersion":1.4},{"id":"6ae5b2fa-378a-4f23-ac73-24b07eaa6e93","name":"OpenAI Chat Model","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","position":[704,-352],"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-5-mini","cachedResultName":"gpt-5-mini"},"options":{},"builtInTools":{}},"credentials":{"openAiApi":{"id":"TefveNaDaMERl1hY","name":"OpenAi account (Eure)"}},"typeVersion":1.3},{"id":"2fee2a5d-f761-4abe-acf6-c8e12fe6abba","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","position":[208,-544],"parameters":{"options":{}},"typeVersion":3},{"id":"813526d1-3e10-4c06-adfd-3d332b4bda4a","name":"Get CRM","type":"n8n-nodes-base.googleSheets","position":[0,-544],"parameters":{"options":{},"filtersUI":{"values":[{"lookupColumn":"EMAIL 1 SEND"}]},"sheetName":{"__rl":true,"mode":"list","value":"gid=0","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM/edit#gid=0","cachedResultName":"Foglio1"},"documentId":{"__rl":true,"mode":"list","value":"1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM/edit?usp=drivesdk","cachedResultName":"Lead nurturing"}},"credentials":{"googleSheetsOAuth2Api":{"id":"JYR6a64Qecd6t8Hb","name":"Google Sheets account"}},"typeVersion":4.7},{"id":"de323153-3e9d-4937-98f1-1ce9bbbff51a","name":"Generate Pixel","type":"n8n-nodes-base.set","position":[480,-528],"parameters":{"options":{},"assignments":{"assignments":[{"id":"e8ad4a95-c1ce-4d64-9a4b-167980da3896","name":"pixel","type":"string","value":"={{ Array.from({length: 15}, () => Math.random().toString(36).charAt(2)).join('') + ['!', '@', '#', '$', '%', '&', '*'][Math.floor(Math.random() * 7)] }}"},{"id":"475402e2-a308-484b-8d99-c37fdbd2e0b4","name":"email","type":"string","value":"email-1"},{"id":"73c0c4d5-d2fd-4025-8a02-c2f376f517cb","name":"webhook_url","type":"string","value":"https://YOUR_N8N_WEBHOOK_URL"}]}},"typeVersion":3.4},{"id":"79f1dc9b-7694-4fe2-a008-3714361ac97f","name":"Email Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[720,-528],"parameters":{"text":"=Write a lead conversion email with a clear call-to-action button. Include this conversion tracking pixel in the HTML body:\n\n<img src=\"{{$json.webhook_url}}?pixel={{ $json.pixel }}&email={{ $json.email }}\" width=\"1\" height=\"1\" style=\"display:none;\">\n\nReturn only the email body in HTML format, no introductions or explanations.","options":{},"promptType":"define"},"typeVersion":3},{"id":"abe94c92-a340-4bf8-a964-8902d738c1c8","name":"Send email","type":"n8n-nodes-base.gmail","position":[1072,-528],"webhookId":"35ca41a3-6095-4263-a760-8be487e2c6ed","parameters":{"sendTo":"={{ $('Get CRM').item.json.EMAIL }}","message":"={{ $json.output }}","options":{},"subject":"Email 1"},"credentials":{"gmailOAuth2":{"id":"nyuHvSX5HuqfMPlW","name":"Gmail account (n3w.it)"}},"typeVersion":2.1},{"id":"a1063c9e-ea92-46c0-b97e-da0933d37fc4","name":"Update CRM","type":"n8n-nodes-base.googleSheets","position":[1296,-528],"parameters":{"columns":{"value":{"row_number":"={{ $('Get CRM').item.json.row_number }}","EMAIL 1 DATE":"={{$now.format('dd/LL/yyyy')}}","EMAIL 1 SEND":"={{ $json.id }}","PIXEL EMAIL 1":"={{ $('Generate Pixel').item.json.pixel }}"},"schema":[{"id":"DATE","type":"string","display":true,"required":false,"displayName":"DATE","defaultMatch":false,"canBeUsedToMatch":true},{"id":"FIRST NAME","type":"string","display":true,"required":false,"displayName":"FIRST NAME","defaultMatch":false,"canBeUsedToMatch":true},{"id":"LAST NAME","type":"string","display":true,"required":false,"displayName":"LAST NAME","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL","type":"string","display":true,"required":false,"displayName":"EMAIL","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL 1 SEND","type":"string","display":true,"required":false,"displayName":"EMAIL 1 SEND","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL 1 DATE","type":"string","display":true,"removed":false,"required":false,"displayName":"EMAIL 1 DATE","defaultMatch":false,"canBeUsedToMatch":true},{"id":"PIXEL EMAIL 1","type":"string","display":true,"required":false,"displayName":"PIXEL EMAIL 1","defaultMatch":false,"canBeUsedToMatch":true},{"id":"OPEN EMAIL 1","type":"string","display":true,"required":false,"displayName":"OPEN EMAIL 1","defaultMatch":false,"canBeUsedToMatch":true},{"id":"CLICK EMAIL 1","type":"string","display":true,"removed":false,"required":false,"displayName":"CLICK EMAIL 1","defaultMatch":false,"canBeUsedToMatch":true},{"id":"REPLY TO EMAIL 1","type":"string","display":true,"required":false,"displayName":"REPLY TO EMAIL 1","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL 2 SEND","type":"string","display":true,"removed":false,"required":false,"displayName":"EMAIL 2 SEND","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL 2 DATE","type":"string","display":true,"removed":false,"required":false,"displayName":"EMAIL 2 DATE","defaultMatch":false,"canBeUsedToMatch":true},{"id":"PIXEL EMAIL 2","type":"string","display":true,"removed":false,"required":false,"displayName":"PIXEL EMAIL 2","defaultMatch":false,"canBeUsedToMatch":true},{"id":"OPEN EMAIL 2","type":"string","display":true,"removed":false,"required":false,"displayName":"OPEN EMAIL 2","defaultMatch":false,"canBeUsedToMatch":true},{"id":"CLICK EMAIL 2","type":"string","display":true,"removed":false,"required":false,"displayName":"CLICK EMAIL 2","defaultMatch":false,"canBeUsedToMatch":true},{"id":"REPLY TO EMAIL 2","type":"string","display":true,"removed":false,"required":false,"displayName":"REPLY TO EMAIL 2","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL 3 SEND","type":"string","display":true,"removed":false,"required":false,"displayName":"EMAIL 3 SEND","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL 3 DATE","type":"string","display":true,"removed":false,"required":false,"displayName":"EMAIL 3 DATE","defaultMatch":false,"canBeUsedToMatch":true},{"id":"PIXEL EMAIL 3","type":"string","display":true,"removed":false,"required":false,"displayName":"PIXEL EMAIL 3","defaultMatch":false,"canBeUsedToMatch":true},{"id":"OPEN EMAIL 3","type":"string","display":true,"removed":false,"required":false,"displayName":"OPEN EMAIL 3","defaultMatch":false,"canBeUsedToMatch":true},{"id":"CLICK EMAIL 3","type":"string","display":true,"removed":false,"required":false,"displayName":"CLICK EMAIL 3","defaultMatch":false,"canBeUsedToMatch":true},{"id":"REPLY TO EMAIL 3","type":"string","display":true,"removed":false,"required":false,"displayName":"REPLY TO EMAIL 3","defaultMatch":false,"canBeUsedToMatch":true},{"id":"row_number","type":"number","display":true,"removed":false,"readOnly":true,"required":false,"displayName":"row_number","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["row_number"],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{},"operation":"update","sheetName":{"__rl":true,"mode":"list","value":"gid=0","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM/edit#gid=0","cachedResultName":"Foglio1"},"documentId":{"__rl":true,"mode":"list","value":"1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM/edit?usp=drivesdk","cachedResultName":"Lead nurturing"}},"credentials":{"googleSheetsOAuth2Api":{"id":"JYR6a64Qecd6t8Hb","name":"Google Sheets account"}},"typeVersion":4.7},{"id":"afc85c64-f00c-4424-8344-aa8696fcdf96","name":"Create data pixel in base64","type":"n8n-nodes-base.set","position":[-32,32],"parameters":{"options":{},"assignments":{"assignments":[{"id":"e8ad4a95-c1ce-4d64-9a4b-167980da3896","name":"data","type":"string","value":"iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCA1LjEuMvu8A7YAAAC2ZVhJZklJKgAIAAAABQAaAQUAAQAAAEoAAAAbAQUAAQAAAFIAAAAoAQMAAQAAAAIAAAAxAQIAEAAAAFoAAABphwQAAQAAAGoAAAAAAAAAYAAAAAEAAABgAAAAAQAAAFBhaW50Lk5FVCA1LjEuMgADAACQBwAEAAAAMDIzMAGgAwABAAAAAQAAAAWgBAABAAAAlAAAAAAAAAACAAEAAgAEAAAAUjk4AAIABwAEAAAAMDEwMAAAAADp1fY4ytpsegAAAA1JREFUGFdjYGBgYAAAAAUAAYoz4wAAAAAASUVORK5CYII"}]}},"typeVersion":3.4},{"id":"e0331f99-3f3b-4726-a116-38ab1a460baf","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-304,-1264],"parameters":{"width":944,"height":528,"content":"## Automate Email Tracking & Generate Pixel for Lead Nurturing\n\nThis workflow automates the process of sending personalized lead-nurturing emails and tracking when each recipient opens the message through a custom tracking pixel. It integrates **Google Sheets**, **Gmail**, **OpenAI**, and **webhooks** to generate, deliver, and monitor engagement with your email sequence.\n\nIt sends personalized emails containing a unique, invisible tracking pixel and then monitors who opens the email by detecting when the pixel is loaded, logging the activity back to a Google Sheets CRM.\n\n### **How it works:**\n\nThis workflow automates personalized lead-nurturing by integrating Google Sheets, Gmail, OpenAI, and a webhook. It retrieves unsent leads from a CRM-style Google Sheet, generates a unique tracking pixel per lead, and uses OpenAI to craft individualized HTML emails embedding the pixel. Gmail then sends the emails and logs the send status, pixel ID, and date in the sheet. When a recipient opens the email, the tracking pixel triggers an n8n webhook that captures the event, matches the pixel ID to the lead, and updates the sheet with an “opened” status—creating a live engagement tracker directly within Google Sheets.\n\n\n### **Setup steps:**\n\nCopy the provided Google Sheet template and populate it with lead data. In the n8n workflow, update all Google Sheets node fields to reference your sheet and replace the placeholder `webhook_url` with your actual webhook endpoint URL. Configure credentials for Google Sheets, Gmail, and OpenAI within n8n. Test the workflow by sending sample emails and verifying that tracking pixel activity updates the correct fields in your sheet. Once confirmed, activate the workflow to enable automated lead nurturing and real-time open tracking.\n"},"typeVersion":1},{"id":"0985436f-d56b-43a1-83b1-d74152b03c83","name":"Create pixel image","type":"n8n-nodes-base.convertToFile","position":[256,32],"parameters":{"options":{"mimeType":"image/png"},"operation":"toBinary","sourceProperty":"data"},"typeVersion":1.1},{"id":"f4a9d59d-25ec-428a-bfd3-bea81fe5a181","name":"Get vars","type":"n8n-nodes-base.set","position":[480,160],"parameters":{"options":{},"assignments":{"assignments":[{"id":"3c40f4c6-de0e-43da-870d-937ba9740ed0","name":"pixel","type":"string","value":"={{ $('Webhook').item.json.query.pixel }}"},{"id":"25584f1f-d40a-43b6-8e04-bb7ceadcdfe6","name":"email","type":"string","value":"={{ $('Webhook').item.json.query.email }}"}]}},"typeVersion":3.4},{"id":"575935b6-4709-4146-93ee-c6bd47215cad","name":"Update Open email 1","type":"n8n-nodes-base.googleSheets","position":[720,160],"parameters":{"columns":{"value":{"OPEN EMAIL 1":"yes","PIXEL EMAIL 1":"={{ $json.pixel }}"},"schema":[{"id":"DATE","type":"string","display":true,"required":false,"displayName":"DATE","defaultMatch":false,"canBeUsedToMatch":true},{"id":"FIRST NAME","type":"string","display":true,"required":false,"displayName":"FIRST NAME","defaultMatch":false,"canBeUsedToMatch":true},{"id":"LAST NAME","type":"string","display":true,"required":false,"displayName":"LAST NAME","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL","type":"string","display":true,"required":false,"displayName":"EMAIL","defaultMatch":false,"canBeUsedToMatch":true},{"id":"EMAIL 1 SEND","type":"string","display":true,"required":false,"displayName":"EMAIL 1 SEND","defaultMatch":false,"canBeUsedToMatch":true},{"id":"PIXEL EMAIL 1","type":"string","display":true,"removed":false,"required":false,"displayName":"PIXEL EMAIL 1","defaultMatch":false,"canBeUsedToMatch":true},{"id":"OPEN EMAIL 1","type":"string","display":true,"required":false,"displayName":"OPEN EMAIL 1","defaultMatch":false,"canBeUsedToMatch":true},{"id":"REPLY TO EMAIL 1","type":"string","display":true,"required":false,"displayName":"REPLY TO EMAIL 1","defaultMatch":false,"canBeUsedToMatch":true},{"id":"row_number","type":"number","display":true,"removed":true,"readOnly":true,"required":false,"displayName":"row_number","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["PIXEL EMAIL 1"],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{},"operation":"update","sheetName":{"__rl":true,"mode":"list","value":"gid=0","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM/edit#gid=0","cachedResultName":"Foglio1"},"documentId":{"__rl":true,"mode":"list","value":"1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM/edit?usp=drivesdk","cachedResultName":"Lead nurturing"}},"credentials":{"googleSheetsOAuth2Api":{"id":"JYR6a64Qecd6t8Hb","name":"Google Sheets account"}},"typeVersion":4.7},{"id":"674a755d-2c6f-480b-88bb-54efd4d9d193","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[160,-704],"parameters":{"color":7,"width":480,"height":432,"content":"## STEP 2 - Set webook url\n\nSet webook url from the node trigger sottostante. Fai attenzione che se inserisci l'ulr del webhook di produzione devi attivare il WF per fare in modo che triggeri"},"typeVersion":1},{"id":"0a088b0d-417c-472e-9e72-8975678df607","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[-304,-704],"parameters":{"color":7,"width":448,"height":432,"content":"## STEP 1 - Clone CRM in Google Sheet\n\n[Clone this sheet](https://docs.google.com/spreadsheets/d/1zgmgqTW3IVfI9BqCGyXHvDj1F80Yn8ibuwAjT-cxSmM/edit?usp=sharing) e compila i campi \"Data\", \"First Name\", \"Last Name\" and \"Email\""},"typeVersion":1},{"id":"a106a081-0da8-484b-a667-b3cb35300454","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[656,-704],"parameters":{"color":7,"width":768,"height":432,"content":"## STEP 3 - Generate and send Email 1\n\nSet webook url from the node trigger sottostante. Fai attenzione che se inserisci l'ulr del webhook di produzione devi attivare il WF per fare in modo che triggeri"},"typeVersion":1},{"id":"7ef059a0-164a-4a41-96cc-6da417f1b480","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[-304,-128],"parameters":{"color":7,"width":704,"height":448,"content":"## STEP 4\nWhen the image is loaded by the recipient's email client, the webhook is triggered, capturing the pixel_id and the email to identify who opened the email"},"typeVersion":1},{"id":"6c3296ec-d145-4ab7-8cb4-0e251d8e149b","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","position":[416,48],"parameters":{"color":7,"width":496,"height":272,"content":"## STEP 5 - Update CRM\nUpdate the lead who opened the email"},"typeVersion":1}],"active":false,"pinData":{},"settings":{"executionOrder":"v1"},"versionId":"3513e341-5e4f-4cb2-9df4-dde99601f8e4","connections":{"Get CRM":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"Create data pixel in base64","type":"main","index":0}]]},"Get vars":{"main":[[{"node":"Update Open email 1","type":"main","index":0}]]},"Send email":{"main":[[{"node":"Update CRM","type":"main","index":0}]]},"Update CRM":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Email Agent":{"main":[[{"node":"Send email","type":"main","index":0}]]},"Generate Pixel":{"main":[[{"node":"Email Agent","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Generate Pixel","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"Email Agent","type":"ai_languageModel","index":0}]]},"Create pixel image":{"main":[[{"node":"Respond to Webhook","type":"main","index":0},{"node":"Get vars","type":"main","index":0}]]},"Create data pixel in base64":{"main":[[{"node":"Create pixel image","type":"main","index":0}]]},"When clicking ‘Execute workflow’":{"main":[[{"node":"Get CRM","type":"main","index":0}]]}}}