{"id":"rtrmjYTV4NV5gIzt","meta":{"instanceId":"f6e8ad6763839b50a3ab3bea5512dc60976f81a6273178925f946fc7a00549a8"},"name":"Property Maintenance Request Tracking and Escalation System","tags":[],"nodes":[{"id":"2c84f6a8-75e3-4d55-b519-6495956a102e","name":"Maintenance Request Webhook","type":"n8n-nodes-base.webhook","position":[5040,784],"webhookId":"a3bc5998-ece4-48ee-a5d6-400a6e75019a","parameters":{"path":"maintenance-request","options":{},"httpMethod":"POST","responseMode":"lastNode"},"typeVersion":2.1},{"id":"25d01b33-d950-4535-829f-a087ba380f5e","name":"Workflow Configuration","type":"n8n-nodes-base.set","position":[5264,784],"parameters":{"options":{},"assignments":{"assignments":[{"id":"id-1","name":"slaHoursHigh","type":"number","value":2},{"id":"id-2","name":"slaHoursMedium","type":"number","value":24},{"id":"id-3","name":"slaHoursLow","type":"number","value":72},{"id":"id-4","name":"managerEmail","type":"string","value":"<__PLACEHOLDER_VALUE__Manager email address__>"},{"id":"id-5","name":"slackChannel","type":"string","value":"<__PLACEHOLDER_VALUE__Slack channel ID__>"},{"id":"id-6","name":"summaryEmail","type":"string","value":"<__PLACEHOLDER_VALUE__Property management team email__>"}]},"includeOtherFields":true},"typeVersion":3.4},{"id":"700c99d6-8828-4ceb-8643-ff8147c72438","name":"Normalize Request Fields","type":"n8n-nodes-base.set","position":[5488,784],"parameters":{"options":{},"assignments":{"assignments":[{"id":"id-1","name":"tenant","type":"string","value":"={{ $json.body.tenant || $json.body.tenantName || 'Unknown' }}"},{"id":"id-2","name":"unit","type":"string","value":"={{ $json.body.unit || $json.body.unitNumber || 'Unknown' }}"},{"id":"id-3","name":"issue","type":"string","value":"={{ $json.body.issue || $json.body.description || 'No description provided' }}"},{"id":"id-4","name":"submittedAt","type":"string","value":"={{ $now.toISO() }}"},{"id":"id-5","name":"requestId","type":"string","value":"={{ $runIndex + '-' + Date.now() }}"},{"id":"id-6","name":"status","type":"string","value":"open"}]},"includeOtherFields":true},"typeVersion":3.4},{"id":"67650de5-f39f-4d79-b7b2-d01867726199","name":"Classify Urgency with AI","type":"@n8n/n8n-nodes-langchain.openAi","position":[5760,800],"parameters":{"modelId":{"mode":"id","value":"gpt-4o-mini"},"options":{"temperature":0.3,"instructions":"You are a maintenance request triage assistant. Classify the urgency of maintenance requests as low, medium, or high based on the issue description.\n\nCriteria:\n- HIGH: Safety hazards, water leaks, no heat/AC in extreme weather, security issues, major appliance failures\n- MEDIUM: Minor leaks, appliance malfunctions, electrical issues (non-emergency), pest problems\n- LOW: Cosmetic issues, minor repairs, routine maintenance\n\nRespond with ONLY one word: low, medium, or high"},"responses":{"values":[{"content":"=Maintenance issue: {{ $json.issue }}"}]},"builtInTools":{}},"credentials":{"openAiApi":{"id":"HTy8dVDHzRHtxXLm","name":"n8n free OpenAI API credits"}},"typeVersion":2},{"id":"3f032976-fb18-4ea1-af59-1a9575cac950","name":"Log Request to Sheets","type":"n8n-nodes-base.googleSheets","position":[6064,784],"parameters":{"columns":{"value":{"unit":"={{ $json.unit }}","issue":"={{ $json.issue }}","status":"={{ $json.status }}","tenant":"={{ $json.tenant }}","urgency":"={{ $json.output.toLowerCase().trim() }}","requestId":"={{ $json.requestId }}","submittedAt":"={{ $json.submittedAt }}"},"schema":[{"id":"requestId","type":"string","display":true,"required":false,"displayName":"requestId","defaultMatch":true,"canBeUsedToMatch":true},{"id":"tenant","type":"string","display":true,"required":false,"displayName":"tenant","defaultMatch":true,"canBeUsedToMatch":true},{"id":"unit","type":"string","display":true,"required":false,"displayName":"unit","defaultMatch":true,"canBeUsedToMatch":true},{"id":"issue","type":"string","display":true,"required":false,"displayName":"issue","defaultMatch":true,"canBeUsedToMatch":true},{"id":"urgency","type":"string","display":true,"required":false,"displayName":"urgency","defaultMatch":true,"canBeUsedToMatch":true},{"id":"status","type":"string","display":true,"required":false,"displayName":"status","defaultMatch":true,"canBeUsedToMatch":true},{"id":"submittedAt","type":"string","display":true,"required":false,"displayName":"submittedAt","defaultMatch":true,"canBeUsedToMatch":true}],"mappingMode":"autoMapInputData","matchingColumns":["requestId","tenant","unit","issue","urgency","status","submittedAt"]},"options":{},"operation":"append","sheetName":{"__rl":true,"mode":"name","value":"<__PLACEHOLDER_VALUE__Sheet name (e.g., Maintenance Requests)__>"},"documentId":{"__rl":true,"mode":"id","value":"<__PLACEHOLDER_VALUE__Google Sheets document ID__>"}},"credentials":{"googleSheetsOAuth2Api":{"id":"5b6oIAuqcO9HRb2A","name":"Google Sheets account 3"}},"typeVersion":4.7},{"id":"031c1e22-a13e-486c-b0fb-b26281d2afa2","name":"Wait for SLA Window","type":"n8n-nodes-base.wait","position":[6288,784],"webhookId":"00289047-0361-46d2-bdd9-3d7b10f71181","parameters":{"unit":"hours","amount":"={{ $('Workflow Configuration').first().json.slaHoursHigh }}"},"typeVersion":1.1},{"id":"69ffa4f9-0857-4c85-8e57-fdc5a3dd63f9","name":"Check Request Status","type":"n8n-nodes-base.googleSheets","position":[6512,784],"parameters":{"options":{},"filtersUI":{"values":[{"lookupValue":"={{ $json.requestId }}","lookupColumn":"requestId"}]},"sheetName":{"__rl":true,"mode":"name","value":"<__PLACEHOLDER_VALUE__Sheet name (same as Log Request)__>"},"documentId":{"__rl":true,"mode":"id","value":"<__PLACEHOLDER_VALUE__Google Sheets document ID (same as Log Request)__>"}},"credentials":{"googleSheetsOAuth2Api":{"id":"5b6oIAuqcO9HRb2A","name":"Google Sheets account 3"}},"typeVersion":4.7},{"id":"31aec070-cd15-44f2-a2e0-8bf8649d82c4","name":"Check if Resolved","type":"n8n-nodes-base.switch","position":[6736,784],"parameters":{"rules":{"values":[{"outputKey":"unresolved","conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"operator":{"type":"string","operation":"notEquals"},"leftValue":"={{ $json.status }}","rightValue":"resolved"}]},"renameOutput":true}]},"options":{"fallbackOutput":"none"}},"typeVersion":3.3},{"id":"8e046dd9-dcea-4b00-a6b6-190c37114333","name":"Route by Urgency","type":"n8n-nodes-base.switch","position":[6960,768],"parameters":{"rules":{"values":[{"outputKey":"high","conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.urgency }}","rightValue":"high"}]},"renameOutput":true},{"outputKey":"medium","conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.urgency }}","rightValue":"medium"}]},"renameOutput":true},{"outputKey":"low","conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.urgency }}","rightValue":"low"}]},"renameOutput":true}]},"options":{"fallbackOutput":"none"}},"typeVersion":3.3},{"id":"e0f27b19-f02a-4e0f-971f-eb0dad139fb1","name":"Send Slack Alert (High)","type":"n8n-nodes-base.slack","position":[7184,976],"webhookId":"77ad4c26-5569-45b1-a91c-27e86197b184","parameters":{"text":"=üö® *HIGH PRIORITY MAINTENANCE REQUEST*\n\n*Request ID:* {{ $json.requestId }}\n*Unit:* {{ $json.unit }}\n*Tenant:* {{ $json.tenant }}\n*Issue:* {{ $json.issue }}\n*Submitted:* {{ $json.submittedAt }}\n*Status:* UNRESOLVED after SLA window\n\nThis request requires immediate attention!","select":"channel","channelId":{"__rl":true,"mode":"id","value":"={{ $('Workflow Configuration').first().json.slackChannel }}"},"otherOptions":{}},"typeVersion":2.3},{"id":"d17de422-90df-425b-99f0-331d427283de","name":"Email Manager (High)","type":"n8n-nodes-base.emailSend","position":[7408,976],"webhookId":"1225a780-af47-462f-b6df-e83f2f4b254c","parameters":{"text":"=HIGH PRIORITY MAINTENANCE REQUEST\n\nRequest ID: {{ $json.requestId }}\nUnit: {{ $json.unit }}\nTenant: {{ $json.tenant }}\nIssue: {{ $json.issue }}\nSubmitted: {{ $json.submittedAt }}\nUrgency: HIGH\nStatus: UNRESOLVED\n\nThis request has exceeded the SLA window and requires immediate attention.\n\nPlease address this issue as soon as possible.","options":{},"subject":"=URGENT: Unresolved High Priority Maintenance Request - Unit {{ $json.unit }}","toEmail":"={{ $('Workflow Configuration').first().json.managerEmail }}","fromEmail":"<__PLACEHOLDER_VALUE__Sender email address__>","emailFormat":"text"},"typeVersion":2.1},{"id":"b6ecc26f-2bdf-4ea0-9392-49d04dbb1f1a","name":"Send Slack Alert (Medium)","type":"n8n-nodes-base.slack","position":[7184,592],"webhookId":"904cfa2c-0fb3-47ba-bb64-b4adfead41d0","parameters":{"text":"=‚ö†Ô∏è *MEDIUM PRIORITY MAINTENANCE REQUEST*\n\n*Request ID:* {{ $json.requestId }}\n*Unit:* {{ $json.unit }}\n*Tenant:* {{ $json.tenant }}\n*Issue:* {{ $json.issue }}\n*Submitted:* {{ $json.submittedAt }}\n*Status:* UNRESOLVED after SLA window\n\nPlease review and address this request.","select":"channel","channelId":{"__rl":true,"mode":"id","value":"={{ $('Workflow Configuration').first().json.slackChannel }}"},"otherOptions":{}},"typeVersion":2.3},{"id":"d2c40f69-b8a7-438b-b1a4-7b2390fd40b0","name":"Log Low Priority (No Alert)","type":"n8n-nodes-base.set","position":[7184,784],"parameters":{"options":{},"assignments":{"assignments":[{"id":"id-1","name":"escalationNote","type":"string","value":"Low priority - logged only, no alert sent"}]},"includeOtherFields":true},"typeVersion":3.4},{"id":"35a1be34-000c-4358-811d-e3ed0f32ae21","name":"Daily Summary Schedule","type":"n8n-nodes-base.scheduleTrigger","position":[5040,1200],"parameters":{"rule":{"interval":[{"triggerAtHour":8}]}},"typeVersion":1.3},{"id":"38ab9c82-a235-43e3-9542-629a28c19cd3","name":"Get Unresolved Requests","type":"n8n-nodes-base.googleSheets","position":[5264,1200],"parameters":{"options":{},"filtersUI":{"values":[{"lookupValue":"resolved","lookupColumn":"status"}]},"sheetName":{"__rl":true,"mode":"name","value":"<__PLACEHOLDER_VALUE__Sheet name (same as Log Request)__>"},"documentId":{"__rl":true,"mode":"id","value":"<__PLACEHOLDER_VALUE__Google Sheets document ID (same as Log Request)__>"}},"credentials":{"googleSheetsOAuth2Api":{"id":"5b6oIAuqcO9HRb2A","name":"Google Sheets account 3"}},"typeVersion":4.7},{"id":"08664562-123f-482f-a2c0-622a12ad1261","name":"Aggregate Unresolved Requests","type":"n8n-nodes-base.aggregate","position":[5488,1200],"parameters":{"options":{},"aggregate":"aggregateAllItemData"},"typeVersion":1},{"id":"e01dd018-0c83-48dd-800f-ebe23f9632af","name":"Send Daily Summary Email","type":"n8n-nodes-base.emailSend","position":[5712,1200],"webhookId":"ee1b6e3e-37da-4190-b053-97746d806375","parameters":{"text":"=DAILY UNRESOLVED MAINTENANCE REQUESTS SUMMARY\n\nDate: {{ $now.toFormat('yyyy-MM-dd') }}\nTotal Unresolved: {{ $json.data.length }}\n\n{{ $json.data.map(r => `Request ID: ${r.requestId}\nUnit: ${r.unit}\nTenant: ${r.tenant}\nIssue: ${r.issue}\nUrgency: ${r.urgency}\nSubmitted: ${r.submittedAt}\n---`).join('\\n') }}\n\nPlease review and address these outstanding requests.","options":{},"subject":"=Daily Maintenance Request Summary - {{ $now.toFormat('yyyy-MM-dd') }}","toEmail":"={{ $('Workflow Configuration').first().json.summaryEmail }}","fromEmail":"<__PLACEHOLDER_VALUE__Sender email address__>","emailFormat":"text"},"typeVersion":2.1},{"id":"11244459-198d-4acd-81d6-c3923b5e00c1","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[4320,656],"parameters":{"width":400,"height":544,"content":"## Main\n\nThis workflow tracks maintenance requests over time and automatically escalates unresolved issues.\nIt demonstrates SLA tracking, AI-based urgency classification, conditional escalation, and reporting.\n\nDesigned for property management teams that want visibility into delayed maintenance issues.\n\n## Setup\n\n- Connect your form or tenant portal to the Webhook trigger\n- Set urgency classification prompt in the AI node\n- Configure SLA delay in the Wait node\n- Connect Google Sheets to track request status\n- Set Slack and Email recipients for escalations and summaries\n"},"typeVersion":1},{"id":"d838bc88-e49b-440e-a338-76d7f2d0f749","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[4992,592],"parameters":{"color":7,"width":688,"height":512,"content":"## Webook & Config"},"typeVersion":1},{"id":"716d5462-9215-4816-8ee7-2b8e03dcb6b0","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[5728,576],"parameters":{"color":7,"width":1312,"height":512,"content":"## AI Logic and Urgency Level"},"typeVersion":1},{"id":"b9e4c1de-7d29-4335-8dea-88104b44d3be","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[7104,464],"parameters":{"color":7,"width":688,"height":640,"content":"## Notify"},"typeVersion":1},{"id":"f4c2a758-838a-4834-92c1-b146013d36d2","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[5008,1136],"parameters":{"color":7,"width":992,"height":224,"content":"## Schedule Trigger"},"typeVersion":1}],"active":false,"pinData":{},"settings":{"executionOrder":"v1"},"versionId":"3f0102c8-d96d-485b-9f37-c6a48f709997","connections":{"Route by Urgency":{"main":[[{"node":"Send Slack Alert (High)","type":"main","index":0}],[{"node":"Send Slack Alert (Medium)","type":"main","index":0}],[{"node":"Log Low Priority (No Alert)","type":"main","index":0}]]},"Check if Resolved":{"main":[[{"node":"Route by Urgency","type":"main","index":0}]]},"Wait for SLA Window":{"main":[[{"node":"Check Request Status","type":"main","index":0}]]},"Check Request Status":{"main":[[{"node":"Check if Resolved","type":"main","index":0}]]},"Log Request to Sheets":{"main":[[{"node":"Wait for SLA Window","type":"main","index":0}]]},"Daily Summary Schedule":{"main":[[{"node":"Get Unresolved Requests","type":"main","index":0}]]},"Workflow Configuration":{"main":[[{"node":"Normalize Request Fields","type":"main","index":0}]]},"Get Unresolved Requests":{"main":[[{"node":"Aggregate Unresolved Requests","type":"main","index":0}]]},"Send Slack Alert (High)":{"main":[[{"node":"Email Manager (High)","type":"main","index":0}]]},"Classify Urgency with AI":{"main":[[{"node":"Log Request to Sheets","type":"main","index":0}]]},"Normalize Request Fields":{"main":[[{"node":"Classify Urgency with AI","type":"main","index":0}]]},"Maintenance Request Webhook":{"main":[[{"node":"Workflow Configuration","type":"main","index":0}]]},"Aggregate Unresolved Requests":{"main":[[{"node":"Send Daily Summary Email","type":"main","index":0}]]}}}